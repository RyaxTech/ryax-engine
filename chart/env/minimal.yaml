global:
  # -- Override the container registry globaly. Useful to use development using registry.ryax.org/dev or for airgapped env
  imageRegistry: 
  imagePullSecrets: []
  imagePullPolicy: IfNotPresent

  nodeSelector: {}
  # -- Leave empty to use the default storage class
  defaultStorageClass: ""

  # -- Ryax specific configuration
  ryax:
    # -- Global log level, can be overriden locally
    logLevel: warning
    # -- Namespace where user's actions are deployed
    userNamespace: "ryaxns-execs"
    # -- Where the monitoring stack goes
    monitoringNamespace: "ryaxns-monitoring"

  monitoring:
    enabled: false
    otlpEndpoint: "tempo.ryaxns-monitoring:4317"

  tls:
    enabled: false
    environment: "development" # development or production
    hostname: "local.ryax.io" # must be a valid dns address
    # Shared but static:
    # datastoreSecret: ryax-datastore-secret
    # internalRegistry: ryax-registry:5000
    # actionRegistrySecret: ryax-registry-creds-secret
    # brokerSecret: ryax-broker-secret
    # authorizationUrl: ryax-authorization:8080
    # filestoreName: ryax-filestore
    # filestoreSecret: ryax-minio-secret
    # internalRegistry: 127.0.0.1:30012
   #  jwtSecret: api-jwt-secret-key

  # -- Needed by bitnami to avoid https://github.com/bitnami/charts/issues/30850
  security:
    allowInsecureImages: true

# -- All common configuration and secrets are created here
common-resources:
  certManager:
    enabled: false

registry:
  credentials:
    enabled: true
    # WARNING: Unsecure ! Change this and regenrate the htpasswd
    password: 'Ro93Wetj44yXAY9Rk-lWlklo0akQIYzp_Eg-UN721zA=='
    username: ryax
    # Need to be Generated 
    # htpasswd -Bbn <VALUE OF THE USERNAME FIELD> "<VALUE OF THE PASSWORD FIELD"
    htpasswd: 'ryax:$2a$12$L4zHsMG0d6UMcmum.egJ.OOP.UBP8pp9dntDWXIdsdST0X5x35wVy'
    pullSecretName: ryax-registry-creds-secret
  ingress:
    enabled: false
  persistence:
    enabled: true
    pvcSize: 20Gi
  priorityClass: backbone
  
datastore:
  pvcSize: 2Gi
  priorityClass: backbone
  
front:
  enabled: true

action-builder:
  priorityClass: "microservices"
  # -- Only necessary if registry.credentials.enabled=true
  actionRegistrySecret: ryax-registry-creds-secret

runner:
  fernetEncryptionKey: RLP2kPn8z-r9WGcckcZHkWLMVLXwKbugfbQONus6bIg==
  priorityClass: microservices

studio:
  authorizationUrl: ryax-authorization:8080
  brokerSecret: ryax-broker-secret
  datastoreSecret: ryax-datastore-secret
  filestoreName: ryax-filestore
  filestoreSecret: ryax-minio-secret
  jwtSecret: api-jwt-secret-key
  logLevel: warning

worker:
  # -- Only necessary if registry.credentials.enabled=true
  actionRegistrySecret: ryax-registry-creds-secret
  config:
    site:
      name: local
      spec:
        namespace: "{{ .Values.global.ryax.userNamespace }}"
        nodePools:
        - cpu: 4
          memory: 8G
          name: default
          selector:
            node.kubernetes.io/instance-type: k3s
      type: KUBERNETES
  filestoreName: ryax-filestore
  filestoreSecret: ryax-minio-secret
  logLevel: warning
  loki:
    monitoring:
      serviceMonitor:
        additionalLabels:
          app: prometheus-operator
          release: prometheus
        enabled: false
    singleBinary:
      persistence:
        size: 10Gi
        storageClass: local-path
  postgresql:
    auth:
      password: InsecurePassw0rd!
  priorityClass: microservices
  promtail:
    serviceMonitor:
      additionalLabels:
        app: prometheus-operator
        release: prometheus
      enabled: false
  intelliscale:
    enabled: false
    
intelliscale:
  image:
    registry: registry.ryax.org
    repository: dev/intelliscale
    tag: helm-chart-globals
  enabled: true
  priorityClass: microservices
  ryax:
    worker:
      configMapName: ryax-worker-config
      serviceName: ryax-worker
  config:
    MIG:
      enabled: false

repository:
  image:
    registry: registry.ryax.org
    repository: dev/repository
    tag: helm-with-globals
  authorizationUrl: ryax-authorization:8080
  brokerSecret: ryax-broker-secret
  datastoreSecret: ryax-datastore-secret
  environment: development
  fernetEncryptionKey: RtsPJX7WrANzevwwnhFJ-3YxwfSicrLzEEmRnXC9cXA==
  jwtSecret: api-jwt-secret-key
  logLevel: warning
  passwordEncryptionKeySecret: ryax-repository-password-encryption-key

minio:
  image:
    repository: bitnamilegacy/minio
  auth:
    existingSecret: ryax-minio-secret
  commonLabels:
    ryax.tech/resource-name: minio
  containerSecurityContext:
    runAsUser: 1200
  metrics:
    enabled: false
  mode: standalone
  persistence:
    enabled: true
    size: 20Gi
  podSecurityContext:
    fsGroup: 1200
  priorityClassName: backbone
  resources:
    limits:
      memory: 1000Mi
    requests:
      cpu: 100m
      memory: 1000Mi
  serviceAccount:
    create: false
  volumePermissions:
    enabled: false

rabbitmq:
  image:
    repository: bitnamilegacy/rabbitmq
  auth:
    existingErlangSecret: ryax-broker-cookie
    existingPasswordSecret: ryax-broker-secret
    resources:
      limits:
        memory: 1000Mi
      requests:
        cpu: 100m
        memory: 500Mi
    tls:
      autoGenerated: false
      enabled: false
    username: ryaxmq
  clustering:
    enabled: false
  extraPlugins: ""
  fullnameOverride: ryax-broker
  metrics:
    enabled: false
    serviceMonitor:
      enabled: true
  persistence:
    enabled: true
    size: 1Gi
    storageClass: local-path
  plugins: rabbitmq_management
  priorityClassName: backbone
  rbac:
    create: false
  serviceAccount:
    create: false
  ulimitNofiles: ""


prometheus:
  enabled: false

tempo:
  enabled: false
